<?php

namespace Database\Seeders;

use App\Models\ContractType;
use App\Models\TaxStatus;
use Illuminate\Database\Seeder;

class ContractTypeTaxStatusSeeder extends Seeder
{
    /**
     * –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–∏–¥–µ—Ä –¥–ª—è —Ç–∏–ø–æ–≤ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –∏ –Ω–∞–ª–æ–≥–æ–≤—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤.
     * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç updateOrCreate –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞.
     */
    public function run(): void
    {
        $this->command->info('üöÄ –ù–∞—á–∞–ª–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ ContractType –∏ TaxStatus...');

        // 1. –°–û–ó–î–ê–ï–ú –¢–ò–ü–´ –î–û–ì–û–í–û–†–û–í
        $contractTypes = [
            [
                'name' => '–¢—Ä—É–¥–æ–≤–æ–π –¥–æ–≥–æ–≤–æ—Ä',
                'code' => 'TD',
                'description' => '–î–æ–≥–æ–≤–æ—Ä –º–µ–∂–¥—É —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–º –∏ —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–µ–º, —Ä–µ–≥—É–ª–∏—Ä—É–µ–º—ã–π –¢—Ä—É–¥–æ–≤—ã–º –∫–æ–¥–µ–∫—Å–æ–º –†–§[citation:1].',
                'is_active' => true,
            ],
            [
                'name' => '–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–æ-–ø—Ä–∞–≤–æ–≤–æ–π –¥–æ–≥–æ–≤–æ—Ä (–ì–ü–•)',
                'code' => 'GPH',
                'description' => '–î–æ–≥–æ–≤–æ—Ä –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç –∏–ª–∏ –æ–∫–∞–∑–∞–Ω–∏–µ —É—Å–ª—É–≥, —Ä–µ–≥—É–ª–∏—Ä—É–µ–º—ã–π –ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∏–º –∫–æ–¥–µ–∫—Å–æ–º –†–§ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–¥—Ä—è–¥, –≤–æ–∑–º–µ–∑–¥–Ω–æ–µ –æ–∫–∞–∑–∞–Ω–∏–µ —É—Å–ª—É–≥)[citation:1][citation:4].',
                'is_active' => true,
            ],
            [
                'name' => '–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å (–ò–ü)',
                'code' => 'IP',
                'description' => '–§–∏–∑–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ò–ü –∏ –≤–µ–¥—É—â–µ–µ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫—É—é –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å.',
                'is_active' => true,
            ],
            [
                'name' => '–û–±—â–µ—Å—Ç–≤–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é (–û–û–û)',
                'code' => 'OOO',
                'description' => '–Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ, —É—á–∞—Å—Ç–Ω–∏–∫ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Å–µ—Ç —Ä–∏—Å–∫ —É–±—ã—Ç–∫–æ–≤ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤–Ω–µ—Å–µ–Ω–Ω–æ–≥–æ –≤–∫–ª–∞–¥–∞.',
                'is_active' => true,
            ],
            [
                'name' => '–°–∞–º–æ–∑–∞–Ω—è—Ç—ã–π (–ù–ü–î)',
                'code' => 'NPD',
                'description' => '–§–∏–∑–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ, –ø—Ä–∏–º–µ–Ω—è—é—â–µ–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –Ω–∞–ª–æ–≥–æ–≤—ã–π —Ä–µ–∂–∏–º ¬´–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥¬ª[citation:2][citation:7].',
                'is_active' => true,
            ],
        ];

        $createdContractTypes = [];
        foreach ($contractTypes as $typeData) {
            $type = ContractType::updateOrCreate(
                ['code' => $typeData['code']], // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á
                $typeData
            );
            $createdContractTypes[$typeData['code']] = $type;
            $this->command->info("   ‚úÖ –¢–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞: {$type->name} (–∫–æ–¥: {$type->code})");
        }

        // 2. –°–û–ó–î–ê–ï–ú –ù–ê–õ–û–ì–û–í–´–ï –°–¢–ê–¢–£–°–´ –ò –ü–†–ò–í–Ø–ó–´–í–ê–ï–ú –ò–• –ö –¢–ò–ü–ê–ú –î–û–ì–û–í–û–†–û–í
        $taxStatuses = [
            // –î–ª—è –¢—Ä—É–¥–æ–≤–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞
            [
                'contract_type_id' => $createdContractTypes['TD']->id,
                'name' => '–ù–î–§–õ 13% (—Ä–µ–∑–∏–¥–µ–Ω—Ç)',
                'tax_rate' => 0.130,
                'description' => '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –Ω–∞–ª–æ–≥–∞ –Ω–∞ –¥–æ—Ö–æ–¥—ã —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü –¥–ª—è –Ω–∞–ª–æ–≥–æ–≤—ã—Ö —Ä–µ–∑–∏–¥–µ–Ω—Ç–æ–≤ –†–§.',
                'is_active' => true,
                'is_default' => true,
            ],

            // –î–ª—è –ì–ü–• —Å —Ñ–∏–∑–ª–∏—Ü–æ–º
            [
                'contract_type_id' => $createdContractTypes['GPH']->id,
                'name' => '–ù–î–§–õ 13% (–ø–æ –¥–æ–≥–æ–≤–æ—Ä—É –ì–ü–•)',
                'tax_rate' => 0.130,
                'description' => '–ù–∞–ª–æ–≥ —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∑–∞–∫–∞–∑—á–∏–∫–æ–º –∫–∞–∫ –Ω–∞–ª–æ–≥–æ–≤—ã–º –∞–≥–µ–Ω—Ç–æ–º —Å –≤—ã–ø–ª–∞—Ç –ø–æ –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–æ-–ø—Ä–∞–≤–æ–≤–æ–º—É –¥–æ–≥–æ–≤–æ—Ä—É[citation:8].',
                'is_active' => true,
                'is_default' => true,
            ],

            // –î–ª—è –ò–ü
            [
                'contract_type_id' => $createdContractTypes['IP']->id,
                'name' => '–£–°–ù ¬´–î–æ—Ö–æ–¥—ã¬ª 6%',
                'tax_rate' => 0.060,
                'description' => '–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è —Å –æ–±—ä–µ–∫—Ç–æ–º ¬´–î–æ—Ö–æ–¥—ã¬ª[citation:3].',
                'is_active' => true,
                'is_default' => true,
            ],
            [
                'contract_type_id' => $createdContractTypes['IP']->id,
                'name' => '–£–°–ù ¬´–î–æ—Ö–æ–¥—ã –º–∏–Ω—É—Å —Ä–∞—Å—Ö–æ–¥—ã¬ª 15%',
                'tax_rate' => 0.150,
                'description' => '–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è —Å –æ–±—ä–µ–∫—Ç–æ–º ¬´–î–æ—Ö–æ–¥—ã –º–∏–Ω—É—Å —Ä–∞—Å—Ö–æ–¥—ã¬ª (—Å—Ç–∞–≤–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–Ω–∏–∂–µ–Ω–∞ —Ä–µ–≥–∏–æ–Ω–∞–º–∏ –¥–æ 5%)[citation:3].',
                'is_active' => true,
                'is_default' => false,
            ],
            [
                'contract_type_id' => $createdContractTypes['IP']->id,
                'name' => '–û–°–ù–û',
                'tax_rate' => 0.200,
                'description' => '–û–±—â–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è (–ù–î–§–õ 13%, –ù–î–° 20%, –Ω–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ).',
                'is_active' => true,
                'is_default' => false,
            ],

            // –î–ª—è –û–û–û
            [
                'contract_type_id' => $createdContractTypes['OOO']->id,
                'name' => '–£–°–ù ¬´–î–æ—Ö–æ–¥—ã¬ª 6%',
                'tax_rate' => 0.060,
                'description' => '–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è –¥–ª—è —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü[citation:3].',
                'is_active' => true,
                'is_default' => true,
            ],
            [
                'contract_type_id' => $createdContractTypes['OOO']->id,
                'name' => '–£–°–ù ¬´–î–æ—Ö–æ–¥—ã –º–∏–Ω—É—Å —Ä–∞—Å—Ö–æ–¥—ã¬ª 15%',
                'tax_rate' => 0.150,
                'description' => '–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è –¥–ª—è —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü[citation:3].',
                'is_active' => true,
                'is_default' => false,
            ],
            [
                'contract_type_id' => $createdContractTypes['OOO']->id,
                'name' => '–û–°–ù–û',
                'tax_rate' => 0.200,
                'description' => '–û–±—â–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ª–æ–≥ –Ω–∞ –ø—Ä–∏–±—ã–ª—å 20%, –ù–î–° 20%, –Ω–∞–ª–æ–≥ –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ).',
                'is_active' => true,
                'is_default' => false,
            ],

            // –î–ª—è –°–∞–º–æ–∑–∞–Ω—è—Ç—ã—Ö (–ù–ü–î)
            [
                'contract_type_id' => $createdContractTypes['NPD']->id,
                'name' => '–ù–ü–î 4% (–¥–ª—è —Ñ–∏–∑–ª–∏—Ü)',
                'tax_rate' => 0.040,
                'description' => '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–æ—Ö–æ–¥–∞ –æ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü[citation:2][citation:7].',
                'is_active' => true,
                'is_default' => true,
            ],
            [
                'contract_type_id' => $createdContractTypes['NPD']->id,
                'name' => '–ù–ü–î 6% (–¥–ª—è –ò–ü/—é—Ä–ª–∏—Ü)',
                'tax_rate' => 0.060,
                'description' => '–ù–∞–ª–æ–≥ –Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–æ—Ö–æ–¥–∞ –æ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π –∏–ª–∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü[citation:2][citation:7].',
                'is_active' => true,
                'is_default' => false,
            ],
        ];

        foreach ($taxStatuses as $statusData) {
            $status = TaxStatus::updateOrCreate(
                [
                    'contract_type_id' => $statusData['contract_type_id'],
                    'name' => $statusData['name']
                ], // –°–æ—Å—Ç–∞–≤–Ω–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á
                $statusData
            );
            
            // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ - –≤—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–¥–µ–ª—å–Ω–æ
            $taxRatePercent = $status->tax_rate * 100;
            $defaultMark = $statusData['is_default'] ? ' [–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é]' : '';
            $this->command->info("   üìä –ù–∞–ª–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å: {$status->name} ({$taxRatePercent}%){$defaultMark}");
        }

        $this->command->info('üéâ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ ContractType –∏ TaxStatus —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã!');
        $this->command->info('üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:');
        $this->command->info("   ‚Ä¢ –¢–∏–ø–æ–≤ –¥–æ–≥–æ–≤–æ—Ä–æ–≤: " . ContractType::count());
        $this->command->info("   ‚Ä¢ –ù–∞–ª–æ–≥–æ–≤—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤: " . TaxStatus::count());
    }
}
